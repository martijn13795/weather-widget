<section class="widget">
  <header class="widget__header">
    <div>
      <p class="eyebrow">Weather widget</p>
      <h1>{{ vm().locationLabel }}</h1>
      <p class="meta" aria-live="polite">
        @if (vm().lastRefreshed) {
          <span>Updated {{ vm().lastRefreshed | date: 'shortTime' }}</span>
        } @else {
          <span>Loading latest dataâ€¦</span>
        }
      </p>
    </div>
    <div class="header__actions">
      <button
        type="button"
        class="ghost"
        (click)="onRefresh()"
        [disabled]="vm().loading"
        aria-label="Refresh weather data"
      >
        Refresh
      </button>
    </div>
  </header>

  <div class="controls">
    <app-search
      (citySearch)="onCitySearch($event)"
      (useGeolocation)="onGeolocate()"
      [geolocationAvailable]="geolocationAvailable"
      [loading]="vm().loading"
    />
    <app-settings [units]="vm().units" (unitsChange)="onUnitsChange($event)" />
  </div>

  @if (vm().error) {
    <div class="alert" role="alert">{{ vm().error }}</div>
  }

  @if (vm().current; as current) {
    <app-current [current]="current" [units]="vm().units" [loading]="vm().loading" />
  }

  @if (vm().hourly.length || vm().daily.length) {
    <app-forecast [hourly]="vm().hourly" [daily]="vm().daily" />
  }
</section>
